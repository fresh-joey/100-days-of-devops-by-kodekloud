# Day 18: Configure LAMP server

## Requirements
xFusionCorp Industries is planning to host a WordPress website on their infra in Stratos Datacenter. They have already done infrastructure configuration‚Äîfor example, on the storage server they already have a shared directory /vaw/www/html that is mounted on each app host under /var/www/html directory. Please perform the following steps to accomplish the task:

a. Install httpd, php and its dependencies on all app hosts.

b. Apache should serve on port 8085 within the apps.

c. Install/Configure MariaDB server on DB Server.

d. Create a database named kodekloud_db5 and create a database user named kodekloud_sam identified as password dCV3szSGNA. Further make sure this newly created user is able to perform all operation on the database you created.

e. Finally you should be able to access the website on LBR link, by clicking on the App button on the top bar. You should see a message like App is able to connect to the database using user kodekloud_sam

## Steps
- We need to install Apache, PHP, and its dependencies on all app servers. Use a script to make it easier
- SSH into the server and create a script with the content. 
  ```ini
  #!/bin/bash

  set -e
  
  echo "Installing Apache (httpd)..."
  sudo yum install -y httpd
  
  echo "Installing PHP and common extensions..."
  sudo yum install -y php php-cli php-common php-mysqlnd php-gd php-mbstring php-xml php-opcache
  
  echo "Configuring Apache to listen on port 8085..."
  
  # Change Listen port
  sudo sed -i 's/^Listen 80$/Listen 8085/' /etc/httpd/conf/httpd.conf
  
  echo "Enabling and starting httpd service..."
  sudo systemctl enable httpd
  sudo systemctl restart httpd
  
  echo "Verifying Apache is running on port 8085..."
  sudo ss -tuln | grep 8085 || echo "Warning: Apache may not be listening on port 8085 yet."
  
  echo "Verifying Apache and PHP installation..."
  httpd -v
  php -v
  
  echo "Installation and configuration complete!"
  ```
- Ensure the script runs and test the services installed.
- SSH into the database server
- Install/Configure MariaDB
  ```console
  sudo dnf install -y mariadb-server
  sudo systemctl enable mariadb
  sudo systemctl start mariadb
  ```
- Log in to the database, create the database and user
  ```console
  sudo mysql
  CREATE DATABASE kodekloud_db5;
  CREATE USER 'kodekloud_sam'@'%' IDENTIFIED BY 'dCV3szSGNA';
  GRANT ALL PRIVILEGES ON kodekloud_db5.* TO 'kodekloud_sam'@'%';
  FLUSH PRIVILEGES
  ```
- Verify the database and the user created
  ```console
  SHOW DATABASES;
  SELECT user, host FROM mysql.user;
  ```
- Check the App link to see if the connection is successful.


## üìù Notes
Make sure the script is made executable \
Ensure you don't create the database user on localhost; if not, the Apps won't be able to access the database with the user credentials
